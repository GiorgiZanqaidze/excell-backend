# Excel Backend (NestJS)

рЃћрЃА рЃљрЃарЃўрЃА Excel рЃцрЃљрЃўрЃџрЃћрЃЉрЃўрЃА рЃерЃљрЃЉрЃџрЃЮрЃюрЃћрЃЉрЃўрЃА рЃњрЃћрЃюрЃћрЃарЃљрЃфрЃўрЃўрЃАрЃљ рЃЊрЃљ рЃљрЃбрЃЋрЃўрЃарЃЌрЃБрЃџрЃў Excel-рЃўрЃА рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљ/рЃерЃћрЃюрЃљрЃ«рЃЋрЃўрЃАрЃЌрЃЋрЃўрЃА рЃерЃћрЃЦрЃЏрЃюрЃўрЃџрЃў API **NestJS**-рЃќрЃћ. рЃАрЃўрЃАрЃбрЃћрЃЏрЃљ рЃЦрЃЏрЃюрЃўрЃА рЃерЃљрЃЉрЃџрЃЮрЃюрЃА, рЃљрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃА рЃљрЃбрЃЋрЃўрЃарЃЌрЃБрЃџ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃА рЃЊрЃљ рЃўрЃюрЃљрЃ«рЃљрЃЋрЃА MongoDB-рЃерЃў.

---

## ­Ъџђ рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃџрЃЮрЃЉрЃћрЃЉрЃў

- **Excel рЃерЃљрЃЉрЃџрЃЮрЃюрЃћрЃЉрЃў**
  - `.xlsx` рЃерЃљрЃЉрЃџрЃЮрЃюрЃўрЃА рЃњрЃћрЃюрЃћрЃарЃљрЃфрЃўрЃљ рЃЊрЃљ рЃњрЃљрЃЊрЃЏрЃЮрЃгрЃћрЃарЃљ (`/file/templates/:templateName/download`).
  - рЃАрЃЋрЃћрЃбрЃћрЃЉрЃўрЃА рЃљрЃдрЃгрЃћрЃарЃљ рЃЊрЃљ рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃћрЃЉрЃў Swagger-рЃерЃў.
- **Excel рЃўрЃЏрЃърЃЮрЃарЃбрЃў MongoDB-рЃерЃў**
  - `.xlsx` рЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃљ (`/file/upload/:templateName`).
  - рЃЋрЃћрЃџрЃћрЃЉрЃўрЃА рЃбрЃўрЃърЃћрЃЉрЃўрЃА рЃЏрЃљрЃарЃбрЃўрЃЋрЃў рЃЋрЃљрЃџрЃўрЃЊрЃљрЃфрЃўрЃљ рЃЊрЃљ рЃерЃћрЃфрЃЊрЃЮрЃЏрЃћрЃЉрЃўрЃА рЃЕрЃљрЃЏрЃЮрЃюрЃљрЃЌрЃЋрЃљрЃџрЃў.
- **Swagger рЃЊрЃЮрЃЎрЃБрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ** Рђћ `/api`.
- **Docker рЃЏрЃ«рЃљрЃарЃЊрЃљрЃГрЃћрЃарЃљ** Рђћ `Dockerfile` рЃЊрЃљ `docker-compose.yml`.
- **рЃАрЃљрЃгрЃДрЃўрЃАрЃў рЃбрЃћрЃАрЃбрЃћрЃЉрЃў** Рђћ unit/e2e boilerplate.

рЃерЃћрЃюрЃўрЃерЃЋрЃюрЃљ: рЃљрЃЏ рЃћрЃбрЃљрЃърЃќрЃћ JSONРєњExcel РђърЃћрЃЦрЃАрЃърЃЮрЃарЃбрЃўрЃАРђю рЃћрЃюрЃЊрЃърЃЮрЃўрЃюрЃбрЃў рЃљрЃа рЃљрЃарЃўрЃА рЃњрЃљрЃюрЃ«рЃЮрЃарЃфрЃўрЃћрЃџрЃћрЃЉрЃБрЃџрЃў (рЃерЃљрЃЉрЃџрЃЮрЃюрЃўрЃА рЃњрЃћрЃюрЃћрЃарЃљрЃфрЃўрЃљ рЃЊрЃљ рЃўрЃЏрЃърЃЮрЃарЃбрЃў рЃљрЃарЃўрЃА рЃњрЃљрЃерЃЋрЃћрЃЉрЃБрЃџрЃў рЃюрЃљрЃгрЃўрЃџрЃў).

---

## ­ЪЊѓ рЃърЃарЃЮрЃћрЃЦрЃбрЃўрЃА рЃАрЃбрЃарЃБрЃЦрЃбрЃБрЃарЃљ (рЃцрЃљрЃЦрЃбрЃЮрЃЉрЃарЃўрЃЋрЃў)

```
excell-backend/
РћюРћђ src/
Рћѓ  РћюРћђ app.controller.ts
Рћѓ  РћюРћђ app.module.ts
Рћѓ  РћюРћђ app.service.ts
Рћѓ  РћюРћђ main.ts
Рћѓ  РћюРћђ file/
Рћѓ  Рћѓ  РћюРћђ file.controller.ts
Рћѓ  Рћѓ  РћюРћђ file.module.ts
Рћѓ  Рћѓ  РћюРћђ file.service.ts
Рћѓ  Рћѓ  РћюРћђ dto/
Рћѓ  Рћѓ  РћћРћђ interfaces/
Рћѓ  РћћРћђ mongo/
Рћѓ     РћюРћђ mongo.module.ts
Рћѓ     РћћРћђ mongo.service.ts
РћюРћђ test/
РћюРћђ docker-compose.yml
РћюРћђ Dockerfile
РћюРћђ env.example
РћюРћђ package.json
РћћРћђ tsconfig.json
```

---

## РџЎ№ИЈ рЃњрЃљрЃарЃћрЃЏрЃЮрЃА рЃЏрЃЮрЃЏрЃќрЃљрЃЊрЃћрЃЉрЃљ (Development)

1. рЃгрЃўрЃюрЃљрЃърЃўрЃарЃЮрЃЉрЃћрЃЉрЃў: Node.js 18+, npm, MongoDB (рЃџрЃЮрЃЎрЃљрЃџрЃБрЃарЃљрЃЊ рЃљрЃю рЃЊрЃЮрЃЎрЃћрЃарЃўрЃЌ)

2. рЃњрЃљрЃарЃћрЃЏрЃЮрЃА рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃў:

```
cp env.example .env
```

рЃЏрЃљрЃерЃўрЃюрЃЋрЃћ рЃАрЃљрЃЎрЃЋрЃљрЃюрЃФрЃЮрЃљ `MONGO_URI` рЃљрЃю `MONGO_HOST/MONGO_PORT/MONGO_DB`. рЃўрЃ«рЃўрЃџрЃћрЃЌ `env.example`.

3. рЃўрЃюрЃАрЃбрЃљрЃџрЃљрЃфрЃўрЃљ рЃЊрЃљ рЃњрЃљрЃерЃЋрЃћрЃЉрЃљ:

```
npm ci
npm run start:dev
```

рЃљрЃърЃў рЃњрЃљрЃўрЃерЃЋрЃћрЃЉрЃљ рЃюрЃљрЃњрЃБрЃџрЃўрЃАрЃ«рЃЏрЃћрЃЋрЃљрЃЊ `http://localhost:3000`-рЃќрЃћ. Swagger: `http://localhost:3000/api`.

---

## ­Ъљ│ Docker / Compose

рЃџрЃЮрЃЎрЃљрЃџрЃБрЃарЃў рЃњрЃљрЃерЃЋрЃћрЃЉрЃљ Mongo-рЃАрЃЌрЃљрЃю рЃћрЃарЃЌрЃљрЃЊ:

```
docker compose up -d --build
```

- API: `http://localhost:3000`
- Swagger: `http://localhost:3000/api`
- Mongo: `mongodb://localhost:27017`

рЃерЃћрЃЏрЃ«рЃћрЃЊрЃЋрЃљрЃарЃћ рЃфрЃЋрЃџрЃљрЃЊрЃћрЃЉрЃў рЃўрЃ«рЃўрЃџрЃћрЃЌ `docker-compose.yml`-рЃерЃў (`PORT`, `MONGO_URI`, Рђд).

---

## ­ЪЊў API рЃћрЃюрЃЊрЃърЃЮрЃўрЃюрЃбрЃћрЃЉрЃў (рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў)

- `GET /` Рђћ рЃ░рЃћрЃџрЃЌрЃЕрЃћрЃЎрЃў
- `GET /file/templates` Рђћ рЃ«рЃћрЃџрЃЏрЃўрЃАрЃљрЃгрЃЋрЃЊрЃЮрЃЏрЃў рЃерЃљрЃЉрЃџрЃЮрЃюрЃћрЃЉрЃў
- `GET /file/templates/:templateName` Рђћ рЃерЃљрЃЉрЃџрЃЮрЃюрЃўрЃА рЃЊрЃћрЃбрЃљрЃџрЃћрЃЉрЃў
- `GET /file/templates/:templateName/download?includeSample=true|false` Рђћ Excel рЃерЃљрЃЉрЃџрЃЮрЃюрЃўрЃА рЃњрЃљрЃЊрЃЏрЃЮрЃгрЃћрЃарЃљ
- `POST /file/upload/:templateName` Рђћ Excel-рЃўрЃА рЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃљ рЃЊрЃљ MongoDB-рЃерЃў рЃерЃћрЃюрЃљрЃ«рЃЋрЃљ
- `GET /file/data/:templateName?page=&limit=` Рђћ рЃњрЃЋрЃћрЃарЃЊрЃўрЃЌрЃЮрЃЉрЃўрЃЌ рЃЏрЃўрЃдрЃћрЃЉрЃљ DB-рЃЊрЃљрЃю

Swagger рЃЊрЃЮрЃЎрЃБрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљ рЃЏрЃЮрЃўрЃфрЃљрЃЋрЃА рЃАрЃЦрЃћрЃЏрЃћрЃЉрЃА (`ExcelTemplate`, рЃАрЃЋрЃћрЃбрЃћрЃЉрЃўрЃА рЃљрЃдрЃгрЃћрЃарЃћрЃЉрЃў рЃЊрЃљ рЃАрЃ«рЃЋ.).

---

## РюЇ№ИЈ рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃћрЃЉрЃў

рЃерЃљрЃЉрЃџрЃЮрЃюрЃћрЃЉрЃўрЃА рЃАрЃўрЃљ:

```
curl http://localhost:3000/file/templates
```

рЃЎрЃЮрЃюрЃЎрЃарЃћрЃбрЃБрЃџрЃў рЃерЃљрЃЉрЃџрЃЮрЃюрЃўрЃА рЃњрЃљрЃЊрЃЏрЃЮрЃгрЃћрЃарЃљ (рЃЏрЃљрЃњ. users):

```
curl -L "http://localhost:3000/file/templates/users/download?includeSample=true" -o users_template.xlsx
```

рЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃљ (users):

```
curl -X POST "http://localhost:3000/file/upload/users" \
  -F "file=@./users_template.xlsx"
```

рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃЏрЃўрЃдрЃћрЃЉрЃљ:

```
curl "http://localhost:3000/file/data/users?page=1&limit=10"
```

---

## ­ЪДЕ Excel рЃерЃљрЃЉрЃџрЃЮрЃюрЃћрЃЉрЃў (рЃљрЃЏрЃЪрЃљрЃЏрЃўрЃюрЃЊрЃћрЃџрЃў)

рЃ«рЃћрЃџрЃЏрЃўрЃАрЃљрЃгрЃЋрЃЊрЃЮрЃЏрЃў рЃерЃљрЃЉрЃџрЃЮрЃюрЃћрЃЉрЃў: `users`, `products`.

- `users` рЃАрЃЋрЃћрЃбрЃћрЃЉрЃў: `firstName` (required), `lastName` (required), `email` (required), `phone`, `birthDate` (date), `isActive` (boolean)
- `products` рЃАрЃЋрЃћрЃбрЃћрЃЉрЃў: `name` (required), `sku` (required), `price` (number, required), `category` (required), `stock` (number), `description`

рЃцрЃљрЃўрЃџрЃўрЃА рЃерЃћрЃЋрЃАрЃћрЃЉрЃўрЃА рЃгрЃћрЃАрЃћрЃЉрЃў:

- рЃЌрЃљрЃарЃўрЃдрЃў: `YYYY-MM-DD`
- Boolean: `true/false`
- рЃарЃўрЃфрЃ«рЃЋрЃћрЃЉрЃў: рЃљрЃЌрЃгрЃўрЃџрЃљрЃЊрЃў рЃгрЃћрЃарЃбрЃўрЃџрЃўрЃЌ, лйл░л┐Лђ. `999.99`

---

## ­ЪДф рЃбрЃћрЃАрЃбрЃўрЃарЃћрЃЉрЃљ / рЃ«рЃљрЃарЃўрЃАрЃ«рЃў

```
npm run test
npm run lint
npm run format
```

---

## Рџа№ИЈ рЃфрЃюрЃЮрЃЉрЃўрЃџрЃў рЃАрЃљрЃЎрЃўрЃЌрЃ«рЃћрЃЉрЃў рЃЊрЃљ рЃњрЃћрЃњрЃЏрЃћрЃЉрЃў

- рЃ░рЃћрЃЊрЃћрЃарЃћрЃЉрЃўрЃА рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃАрЃЮрЃЉрЃљ: рЃњрЃћрЃюрЃћрЃарЃўрЃарЃћрЃЉрЃБрЃџрЃў рЃерЃљрЃЉрЃџрЃЮрЃюрЃў рЃўрЃДрЃћрЃюрЃћрЃЉрЃА рЃљрЃЊрЃљрЃЏрЃўрЃљрЃюрЃўрЃА-рЃгрЃљрЃАрЃљрЃЎрЃўрЃЌрЃ« рЃАрЃљрЃЌрЃљрЃБрЃарЃћрЃЉрЃА ( лйл░л┐Лђ. "First Name"), рЃ«рЃЮрЃџрЃЮ рЃўрЃЏрЃърЃЮрЃарЃбрЃў рЃћрЃџрЃЮрЃЊрЃћрЃЉрЃљ рЃЋрЃћрЃџрЃћрЃЉрЃўрЃА `key`-рЃћрЃЉрЃА ( лйл░л┐Лђ. `firstName`). рЃћрЃА рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃўрЃгрЃЋрЃћрЃЋрЃЊрЃћрЃА рЃЋрЃљрЃџрЃўрЃЊрЃљрЃфрЃўрЃўрЃА рЃерЃћрЃфрЃЊрЃЮрЃЏрЃћрЃЉрЃА. рЃњрЃћрЃњрЃЏрЃљрЃерЃўрЃљ рЃерЃљрЃЉрЃџрЃЮрЃюрЃўрЃЊрЃљрЃю рЃърЃўрЃарЃЊрЃљрЃърЃўрЃа рЃАрЃгрЃЮрЃарЃў `key`-рЃћрЃЉрЃўрЃА рЃЉрЃљрЃўрЃюрЃЊрЃўрЃюрЃњрЃў рЃўрЃЏрЃърЃЮрЃарЃбрЃўрЃАрЃљрЃА.
- Excel рЃЌрЃљрЃарЃўрЃдрЃћрЃЉрЃў: рЃАрЃљрЃГрЃўрЃарЃЮрЃћрЃЉрЃўрЃљ `cellDates: true` рЃЊрЃљ serial-to-date рЃАрЃгрЃЮрЃарЃљрЃЊ рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљ, рЃарЃљрЃЌрЃљ рЃДрЃЋрЃћрЃџрЃљ рЃАрЃфрЃћрЃюрЃљрЃарЃў рЃАрЃгрЃЮрЃарЃљрЃЊ рЃўрЃЏрЃБрЃерЃљрЃЮрЃА.
- рЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃўрЃА рЃџрЃўрЃЏрЃўрЃбрЃћрЃЉрЃў/рЃцрЃўрЃџрЃбрЃарЃћрЃЉрЃў: `env.example`-рЃерЃў рЃљрЃдрЃгрЃћрЃарЃўрЃџрЃў рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃў рЃўрЃюрЃбрЃћрЃњрЃарЃўрЃарЃЊрЃћрЃЉрЃљ рЃљрЃбрЃЋрЃўрЃарЃЌрЃЋрЃўрЃА рЃўрЃюрЃбрЃћрЃарЃАрЃћрЃърЃбрЃЮрЃарЃерЃў.
- Mongo рЃўрЃюрЃЊрЃћрЃЦрЃАрЃћрЃЉрЃў: рЃарЃћрЃЎрЃЮрЃЏрЃћрЃюрЃЊрЃўрЃарЃћрЃЉрЃБрЃџрЃўрЃљ рЃБрЃюрЃўрЃЎрЃљрЃџрЃБрЃарЃў рЃўрЃюрЃЊрЃћрЃЦрЃАрЃћрЃЉрЃў (`users.email`, `products.sku`) рЃЊрЃљ `createdAt` рЃўрЃюрЃЊрЃћрЃЦрЃАрЃў рЃгрЃљрЃарЃЏрЃљрЃЊрЃЮрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА.

рЃЏрЃЮрЃфрЃћрЃЏрЃБрЃџрЃў README рЃљрЃАрЃљрЃ«рЃљрЃЋрЃА рЃЏрЃўрЃЏрЃЊрЃўрЃюрЃљрЃарЃћ рЃАрЃбрЃљрЃбрЃБрЃАрЃА рЃЊрЃљ рЃњрЃќрЃљрЃА рЃерЃћрЃЏрЃЊрЃњрЃЮрЃЏрЃў рЃњрЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃћрЃЉрЃћрЃЉрЃўрЃАрЃЎрЃћрЃю.
